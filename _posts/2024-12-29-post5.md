---
title: Examen Final
date: 2024-12-29 00:00:00 -05:00
categories: [reconnaisance, kill chain, pentesting]
tags: [nmap, kali, metasploit]  # TAG names should always be lowercase
---


**1. Pregunta 1¿Cómo podrías utilizar Procmon y Sysmon juntos para investigar la actividad de un proceso sospechoso?**

uso conjutno de Procmon y Sysmon
para investigar un proceso sospechosode manera efectiva, se pueden usar Procmon y Sysmon en conjunto. Para ello seguiremos los siguientes pasos:

Configuracion de Sysmon:
Instalacion: nos aseguraremos de tener Sysmon instalado en el sistema. Esta herramienta proporciona un registro detallado de envetos relacionados con procesos y actividad de red.
Configuracion de Eventos: Configura Sysmon para capturar eventos relevantes, como:
Event ID 1: creacion de procesos.
Event ID 3: conexiones de red.
Event ID 11: cambios en archivos. - esta configuracion te permitira obtener un panorama detallado de lo que ocurre en el sistema.
Ejecucion de Procmon:
Iniciar Procmon: se ejecuta procmon y comienza a capturar eventos en tiempo real.
Aplicar filtros: filtra los eventos para concetrarte unicamente en el proceso sospechoso. Puedes hacerlo filtrando por el nombre del proceso, su ID o su ruta de acceso.
Analisis de datos:
Correlacionar eventos: una vez capturados los datos, analizar los eventos de ambas herramientas. Buscar patrones y comportamientos inusuales, como accesos a archivos criticos o conexiones a direccion IP desconocidas.
Identificacion de comportamientos maliciosos: si un procesos accede a archivos sensibles o establece conexiones no autorizadas, esto podria indicar actividad maliciosa.
Explica los tipos de eventos que Procmon y Sysmon pueden capturar de forma complementaria.
ambas herramientas capturan diferentes tipos de eventos que se complementan entre si:

Eventos capturados por Procmon:
acceso a archivos: registra operaciones de lectura, escritura y eliminacion de archivos. Esto es util para identificar manipulacion de archivos maliciosos.
Cambios en el registro: Monitorea modificaciones en el registro de Windows, lo que puede señalar cambios no autorizados en la configuracion del sistema.
Conexiones de red: captura intentos de conexion de red, lo que es crucial para identificar comunicaciones sospechosas.
Eventos capturados por Sysmon
Creacion de procesos (Event ID 1): registra cuando y como se inician nuevos procesos, incluyendo la linea de comandos utilizada.
Conexiones de red (Event ID 3): proporciona detalles sobre las conexiones de red que establecen procesos, incluyendo direccion IP y puertos.
Cambios en archivos (Event ID 11): registra la creacion, modificacion y eliminacion de archivos, esencial para rastrear la actividad de malware.

Como se complemtentan: PROCMON OFRECE UN ENFOQUE EN LA OPERACIONES A NIVEL DE ARCHIVO Y REGISTRO, MIENTRAS QUE SYSMON PROPORCIONA CONTEXTO SOBRE LOS PROCESOS Y SU INTERACCION CON LA RED.
Proporciona un ejemplo práctico de cómo identificar un posible comportamiento malicioso en un proceso utilizando ambas herramientas.
Imagina que has identificado un proceso sospechoso llamado malware.exe.

Pasos para la Investigación:
Configuración de Sysmon:
Asegúrate de que Sysmon esté configurado para capturar eventos de creación de procesos y conexiones de red. Esto garantiza que tengas un registro completo de la actividad del proceso.
Ejecución de Procmon:
Filtra Procmon para capturar solo eventos relacionados con malware.exe. Observa cualquier acceso a archivos y cambios en el registro que realice este proceso.
Análisis de Eventos:
Procmon: Si notas que malware.exe accede a archivos en directorios sensibles, como C:\Windows\System32, esto es un indicador de actividad sospechosa.
Sysmon: Revisa si malware.exe establece conexiones a direcciones IP desconocidas. Esto puede señalar comunicación con un servidor malicioso.
Correlación de Datos:
Si observas que malware.exe es creado por un proceso legítimo, como cmd.exe, y simultáneamente accede a archivos críticos, esto refuerza la sospecha de actividad maliciosa.
Documentación y Respuesta:
Registra todos los hallazgos y toma medidas correctivas, como eliminar malware.exe y bloquear la dirección IP involucrada. Asegúrate de documentar el proceso para futuras referencias y mejora de la seguridad.